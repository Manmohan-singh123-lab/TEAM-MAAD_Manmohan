<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BPSK Modulation & Demodulation</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    canvas {
      margin: 20px 0;
      max-width: 100%;
    }
    label, input {
      display: block;
      margin: 10px 0;
    }
  </style>
</head>
<body>
  <h2>BPSK Modulation and Demodulation</h2>
  <label>Binary Input (e.g., 1011001):</label>
  <input type="text" id="binaryInput" value="1010" />

  <label>Carrier Frequency (Hz):</label>
  <input type="number" id="frequency" value="10000" min="0" max="100000" />

  <label>Amplitude (Volts):</label>
  <input type="number" id="amplitude" value="5" min="1" max="10" />

  <button onclick="generateBPSK()">Generate BPSK</button>

  <h3>Carrier Wave</h3>
  <canvas id="carrierChart"></canvas>

  <h3>Modulated Wave (BPSK)</h3>
  <canvas id="bpskChart"></canvas>

  <h3>Demodulated Wave</h3>
  <canvas id="demodChart"></canvas>

  <script>
    function generateBPSK() {
      const binaryInput = document.getElementById("binaryInput").value;
      const freq = parseFloat(document.getElementById("frequency").value);
      const amp = parseFloat(document.getElementById("amplitude").value);
      const bitDuration = 1 / 1000; // 1ms per bit
      const samplingRate = 1000; // 1000 samples per bit

      let t = [], carrier = [], modulated = [], demodulated = [];
      let index = 0;

      for (let bit of binaryInput) {
        for (let i = 0; i < samplingRate; i++) {
          const time = index * (bitDuration / samplingRate);
          t.push(time);
          const carrierSample = amp * Math.cos(2 * Math.PI * freq * time);
          carrier.push(carrierSample);
          const modSample = bit === '1' ? carrierSample : -carrierSample;
          modulated.push(modSample);
          const recoveredBit = modSample * carrierSample > 0 ? amp : -amp;
          demodulated.push(recoveredBit);
          index++;
        }
      }

      const labels = t.map(v => v.toFixed(6));

      plotGraph("carrierChart", labels, carrier, "Carrier Wave");
      plotGraph("bpskChart", labels, modulated, "BPSK Modulated Signal");
      plotGraph("demodChart", labels, demodulated, "Demodulated Signal");
    }

    function plotGraph(canvasId, labels, data, labelName) {
      const ctx = document.getElementById(canvasId).getContext("2d");
      if (window[canvasId + "_chart"]) window[canvasId + "_chart"].destroy();
      window[canvasId + "_chart"] = new Chart(ctx, {
        type: "line",
        data: {
          labels: labels,
          datasets: [
            {
              label: labelName,
              data: data,
              borderColor: "#007bff",
              fill: false,
              pointRadius: 0,
              borderWidth: 1,
            },
          ],
        },
        options: {
          animation: false,
          scales: {
            x: {
              title: {
                display: true,
                text: "Time (s)",
              },
            },
            y: {
              title: {
                display: true,
                text: "Amplitude (V)",
              },
            },
          },
        },
      });
    }
  </script>
</body>
</html>
